<% if flash[:notice] %>
  <p class="text-active"><%= flash[:notice] %></p>
<% end %>
<div class="col-xs-3">
  <% if customer_signed_in? %>
    <h4>アカウント情報</h4>
    <%= attachment_image_tag @customer, :image, format: "jpeg", size:'150x150', id: "img_prev", fallback: "no-image.png", class: "customer_image" %>
    <table class="table">
      <tr>
        <th>ユーザネーム</th>
        <td><%= @customer.username %></td>
      </tr>
      <tr>
        <th>フォロー数</th>
        <td><%= @customer.followings.count %> 人</td>
      </tr>
      <tr>
        <th>フォロワー数</th>
        <td><%= @customer.followers.count %> 人</td>
      </tr>
      <tr>
        <th>つぶやき数</th>
        <td><%= @customer.posts.count %></td>
      </tr>
    </table>
  <% else %>
    <%= link_to "会員登録はこちら", new_customer_registration_path %><br>
    <%= link_to "すでに会員の方はこちら", new_customer_session_path %><br>
    <%= link_to "関係者はこちら", new_admin_session_path %>
  <% end %>
  <div class="teacher_index">
    <h4>講師一覧</h4>
    <% @teachers.each do |teacher| %>
      <%= link_to mypage_path(teacher) do %>
        <%= attachment_image_tag teacher, :image, format: "jpeg", size:'60x60', fallback: "no-image.png" %>
        <%= teacher.username %>
      <% end %>
      <hr>
    <% end %>
  </div>
</div>
<div class="col-xs-5">
  <h3>投稿一覧</h3>
  <% @posts.each do |post| %>
    <div class="post_box">
      <div class="post_box_left">
        <%= attachment_image_tag post.customer, :image, format: "jpeg", size:'80x80', fallback: "no-image.png" %>
      </div>
      <div class="post_box_right">
        <div class="post_body">
          <%= link_to post_path(post) do %>
            <%= post.body %><br>
          <% end %>
        </div>
        <div class="post_reference">
          <%= post.reference %><br>
        </div>
        <%= post.created_at.strftime('%Y/%m/%d') %><br>
        <%= post.comments.count %>件
        <% if customer_signed_in? %>
          <% if post.favorited_by?(current_customer) %>
            <%= link_to post_favorites_path(post), method: :delete do %>
              <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i>
              <%= post.favorites.count %> いいね
            <% end %>
          <% else %>
            <%= link_to post_favorites_path(post), method: :post do %>
              <i class="fa fa-heart-o" aria-hidden="true"></i>
              <%= post.favorites.count %> いいね
            <% end %>
          <% end %>
        <% else %>
          <%= post.favorites.count %> いいね
        <% end %>
      </div>
    </div>
    <% if post.customer == current_customer %>
      <div>
        <%= link_to "削除", post_path(post), method: :delete, class: "btn btn-danger" %>
      </div>
    <% end %>
    <% if customer_signed_in? %>
      <% if current_customer != post.customer %>
        <% if post.customer.followed_by?(current_customer) %>
          <p><%=link_to "フォロー解除", customer_relationships_path(post.customer.id), method: :delete, class: "btn btn-danger" %></p>
        <% else %>
          <p><%=link_to "フォローする", customer_relationships_path(post.customer.id), method: :post, class: "btn btn-pri" %></p>
        <% end %>
      <% end %>
    <% end %>
    <hr>
  <% end %>
</div>
<div class="col-xs-2">
  <% if customer_signed_in? %>
    <%= render 'customers/posts/post_form', post: @post %>
  <% end %>
  <h4>閲覧数ランキング</h4>
</div>